<html>
<head>
	<%- include('../common/imports.ejs') %>
	<link rel="stylesheet" href="/static/styles/antimalware.css">
	<title>AntiMalware | Risultati</title>
</head>
<% if(data.status != 200) { %>
	<body onload="setError(<%= data.status %>, '<%= data.error %>')">
		<%- include('../common/error.ejs') %>
	</body>
<% } else { %>
	<body>
		<%- include('../common/header.ejs') %>
		<div class="body-container">
			Risultati dell'analisi
			<br><br>
			<% if(data.status == 200) { %>
				<table>
					<tr>
						<th>Antimalware engine</th>
						<th>Risultato analisi</th>
					</tr>
					<% Object.keys(data.results).forEach(function(engine) { %>
					<tr>
						<td><%= engine %></td>
						<% if(data.results[engine].category != "malicious") { %>
							<td class="undetected">
								<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24">
							        <path d="M12,21.3c-4.9,0-8.8-4-8.8-8.8c0-4.9,4-8.8,8.8-8.8c4.9,0,8.8,4,8.8,8.8C20.8,17.4,16.9,21.3,12,21.3z M12,4.7   c-4.3,0-7.8,3.5-7.8,7.8c0,4.3,3.5,7.8,7.8,7.8c4.3,0,7.8-3.5,7.8-7.8C19.8,8.2,16.3,4.7,12,4.7z"></path>
							        <path d="M10.4,15.9C10.4,15.9,10.4,15.9,10.4,15.9c-0.2,0-0.3-0.1-0.4-0.2l-2.6-3.3c-0.2-0.2-0.1-0.5,0.1-0.7  c0.2-0.2,0.5-0.1,0.7,0.1l2.2,2.8l5.2-6c0.2-0.2,0.5-0.2,0.7-0.1c0.2,0.2,0.2,0.5,0.1,0.7l-5.6,6.5C10.7,15.9,10.6,15.9,10.4,15.9z"></path>
						     	</svg>
								<%= data.results[engine].category %>
							</td>
						<% } else { %>
							<td class="detected">
								<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24">
									<path d="M12.6,16.9h-1.3v-1.4l1.3,0V16.9z M11.4,14.3V7.6h1.3v6.8H11.4z"></path>
									<path d="M12,21.1c-4.9,0-8.8-4-8.8-8.8s4-8.8,8.8-8.8c4.9,0,8.8,4,8.8,8.8S16.9,21.1,12,21.1z M12,4.4c-4.3,0-7.8,3.5-7.8,7.8
									s3.5,7.8,7.8,7.8c4.3,0,7.8-3.5,7.8-7.8S16.3,4.4,12,4.4z"></path>
								</svg>
								<%= data.results[engine].result %>	
							</td>
						<% } %>
					</tr>
					<% }) %>
				</table>
			<% } else { %>
				Errore <%= data.status %>: <%= data.text %>
			<% } %>
		</div>
	</body>
<% } %>
</html>
<!DOCTYPE html>
<html>
<head>
	<%- include('../common/imports.ejs') %>
	<script src="/static/scripts/antimalware.js" type="text/javascript"></script>
	<script type="text/javascript" src="https://bernii.github.io/gauge.js/dist/gauge.min.js"></script>
	<link rel="stylesheet" href="/static/styles/antimalware.css">
	<title>AntiMalware | Risultati</title>
</head>
<% if(data.status != 200) { %>
	<body onload="setError(<%= data.status %>, '<%= data.error %>')">
		<%- include('../common/error.ejs') %>
	</body>
<% } else { %>
	<body onload="displayResults(<%= data.stats.malicious %>, <%= data.stats.undetected %>, '<%= info.type %>')">
		<%- include('../common/header.ejs') %>
		<div class="body-container">
			<center>
				<div class="gauge-container">
					<div class="gauge-left">
						<canvas id="gauge"></canvas>
						<div id="gauge-value"></div>
					</div>
					<div class="gauge-right">
						<p id="banner"></p>
						<ul style="border: 1px solid #f2f2f2; margin: 0px; padding: 20px 40px;">
							<% if(info.domain == undefined) { %>
								<li><b>File: </b><%= info.name %>
								<li><b>Mimetype: </b><%= info.type %>
								<li><b>Size: </b><%= info.size %> MB
							<% } else { %>
								<li><b>Url: </b><%= info.domain %>
								<li><b>Tipo: </b><%= info.type %>
							<% } %>
						</ul>
					</div>
				</div>
				<br><br>
				<% if(data.status == 200) { %>
					<table id="engines" class="results sortable">
						<tr>
							<th class="sorttable_nosort">Antimalware engine</th>
							<th>Risultato analisi</th>
						</tr>
						<% Object.keys(data.results).forEach(function(engine) { %>
						<tr>
							<td><%= engine %></td>
							<% if(data.results[engine].category == "undetected") { %>
								<td class="undetected" sorttable_customkey="1">
									<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24">
								        <path d="M12,21.3c-4.9,0-8.8-4-8.8-8.8c0-4.9,4-8.8,8.8-8.8c4.9,0,8.8,4,8.8,8.8C20.8,17.4,16.9,21.3,12,21.3z M12,4.7   c-4.3,0-7.8,3.5-7.8,7.8c0,4.3,3.5,7.8,7.8,7.8c4.3,0,7.8-3.5,7.8-7.8C19.8,8.2,16.3,4.7,12,4.7z"></path>
								        <path d="M10.4,15.9C10.4,15.9,10.4,15.9,10.4,15.9c-0.2,0-0.3-0.1-0.4-0.2l-2.6-3.3c-0.2-0.2-0.1-0.5,0.1-0.7  c0.2-0.2,0.5-0.1,0.7,0.1l2.2,2.8l5.2-6c0.2-0.2,0.5-0.2,0.7-0.1c0.2,0.2,0.2,0.5,0.1,0.7l-5.6,6.5C10.7,15.9,10.6,15.9,10.4,15.9z"></path>
							     	</svg>
									Innocuo
								</td>
							<% } else if(data.results[engine].category == "malicious") { %>
								<td class="detected" sorttable_customkey="0">
									<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24">
										<path d="M12.6,16.9h-1.3v-1.4l1.3,0V16.9z M11.4,14.3V7.6h1.3v6.8H11.4z"></path>
										<path d="M12,21.1c-4.9,0-8.8-4-8.8-8.8s4-8.8,8.8-8.8c4.9,0,8.8,4,8.8,8.8S16.9,21.1,12,21.1z M12,4.4c-4.3,0-7.8,3.5-7.8,7.8
										s3.5,7.8,7.8,7.8c4.3,0,7.8-3.5,7.8-7.8S16.3,4.4,12,4.4z"></path>
									</svg>
									Malevolo 
									<% if(info.type != "url") { %>
										[<%= data.results[engine].result %>] 
									<% } %>
								</td>
							<% } else if(data.results[engine].category == "type-unsupported") { %>
								<td sorttable_customkey = "2">
									<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" fill="currentColor" viewBox="0 0 24 24">
										<path d="M19.1,20.4c-0.1,0-0.2,0-0.3-0.1L3.5,6.3c-0.2-0.2-0.2-0.4,0-0.6c0.2-0.2,0.5-0.2,0.6,0l15.2,14c0.2,0.2,0.2,0.4,0,0.6
										C19.3,20.4,19.2,20.4,19.1,20.4z"></path>
										<path fill="none" d="M6.7,8.1L4.1,5.7C4.1,5.6,3.9,5.6,3.8,5.6c-0.1,0-0.2,0-0.3,0.1c-0.2,0.2-0.2,0.4,0,0.6l2.6,2.4
										C6.3,8.5,6.5,8.3,6.7,8.1z"></path>
										<path fill="none" d="M17,17.5L7.5,8.8C7.3,9,7.1,9.2,6.9,9.4l9.5,8.7C16.6,17.9,16.8,17.7,17,17.5z"></path>
										<path fill="none" d="M17.7,18.1c-0.2,0.2-0.4,0.4-0.6,0.6l1.6,1.5c0.1,0.1,0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.3-0.1
										c0.2-0.2,0.2-0.4,0-0.6L17.7,18.1z"></path>
										<path d="M7.5,8.8L6.7,8.1C6.5,8.3,6.3,8.5,6.1,8.7l0.7,0.7C7.1,9.2,7.3,9,7.5,8.8z"></path>
										<path d="M17.7,18.1L17,17.5c-0.2,0.2-0.4,0.4-0.6,0.6l0.7,0.7C17.3,18.6,17.5,18.4,17.7,18.1z"></path>
										<path d="M21.5,11.7c-0.2-0.2-4.3-6.1-9.5-6.1c-1.7,0-3.4,0.6-4.8,1.5l0.3,0.3L8,7.9c1.2-0.7,2.6-1.2,4-1.2c4.1,0,7.7,4.3,8.5,5.4
										c-0.5,0.7-1.9,2.4-3.9,3.7l0.8,0.7c2.6-1.8,4.3-4.2,4.3-4.5C21.6,11.9,21.6,11.8,21.5,11.7z"></path>
										<path d="M12,17.4c-1.9,0-5-0.9-8.5-5.4c0,0,0,0,0,0c0.3-0.4,1.1-1.4,2.1-2.3L5.5,9.5L4.9,8.9c-1.4,1.3-2.3,2.5-2.4,2.8
										c-0.1,0.2,0,0.5,0.1,0.6c0,0,0.1,0.1,0.2,0.2c3.8,4.8,7.1,5.8,9.3,5.8c0.9,0,1.8-0.2,2.6-0.5l-0.8-0.8C13.2,17.3,12.6,17.4,12,17.4
										z"></path>
										<path d="M14.8,14.1c0.4-0.6,0.7-1.3,0.7-2.1c0-1.9-1.6-3.5-3.5-3.5c-0.9,0-1.7,0.4-2.3,0.9l0.7,0.7c0.4-0.4,1-0.6,1.6-0.6
										c1.4,0,2.5,1.1,2.5,2.5c0,0.5-0.2,1-0.5,1.4L14.8,14.1z"></path>
										<path d="M12,15.5l-3.5-3.2C8.7,14.1,10.2,15.5,12,15.5C12,15.5,12,15.5,12,15.5z"></path>
										<path d="M17.7,18.1L17,17.5L16.5,17l-0.8-0.7l-1.6-1.5l-0.8-0.7l-3.5-3.2L9,10.2L7.5,8.8L7.1,8.4L6.7,8.1L6.3,7.7l-2.2-2
										C4.1,5.6,3.9,5.6,3.8,5.6c-0.1,0-0.2,0-0.3,0.1c-0.2,0.2-0.2,0.4,0,0.6l2.1,1.9l0.5,0.5l0.2,0.2l0.5,0.5L8.7,11l0.9,0.8l2.9,2.6
										l0.9,0.8l1.6,1.5l0.8,0.7l0.7,0.7l0.7,0.7l1.6,1.5c0.1,0.1,0.2,0.1,0.3,0.1c0.1,0,0.2,0,0.3-0.1c0.2-0.2,0.2-0.4,0-0.6L17.7,18.1z"></path>
									</svg>
									Tipo di file non supportato
								</td>
							<% } else { %>
								<td sorttable_customkey="2"><%= data.results[engine].category %></td>
							<% } %>
						</tr>
						<% }) %>
					</table>
				<% } else { %>
					Errore <%= data.status %>: <%= data.text %>
				<% } %>
			</center>
		</div>
	</body>
<% } %>
</html>
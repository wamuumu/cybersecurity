<!DOCTYPE html>
<html>
<% if(data.status != 200) { %>
	<%- include('../common/error.ejs', {data: data}) %>
<% } else { %>
	<head>
		<%- include('../common/imports.ejs') %>
		<link rel="stylesheet" href="/static/styles/cve.css">
		<script src="/static/scripts/cve.js" type="text/javascript"></script>
		<title><%= data['cve'].id %></title>
	</head>
	<body onload="setCVEDetail()">
		<%- include('../common/header.ejs') %>
		<div class="body-container">
			<div class="table-container">
				<table>
					<tr>
						<th colspan="4"><%= data['cve'].id %></th>
					</tr>
					<tr>
						<td class="red">Descrizione</td>
						<td><%= data['cve'].summary %></td>
						<td colspan="2">
							<table>
								<tr>
									<th colspan="2">Timestamps</th>
								</tr>	
								<tr>
									<td>Ultimo aggiornamento</td>
									<td><%= data['cve'].updated %></td>
								</tr>
								<tr>
									<td>Data pubblicazione</td>
									<td><%= data['cve'].published %></td>
								</tr>
							</table>
						</td>
					</tr>
					<tr>
						<td class="red">Riferimenti</td>
						<td class="slider">
							<i class="fa fa-angle-down"></i>
							<ul>
								<% for(var i=0; i < data['cve'].references.length; i++) { %>
									<li class="left">
										<a href="<%= data['cve'].references[i] %>"><%= data['cve'].references[i] %></a>
									</li>
								<% } %>
							</ul>
						</td>
						<td class="red">Configurazioni vulnerabili</td>
						<td class="slider">
							<i class="fa fa-angle-down"></i>
							<ul>
								<% for(var i=0; i < data['cve'].vulnerable_configuration.length; i++) { %>
									<li class="left">
										<%= data['cve'].vulnerable_configuration[i] %>
									</li>
								<% } %>
							</ul>
						</td>
					</tr>
					<tr>
						<% if(data['cve'].capec != 'NONE'){ %>
							<td class="red">CAPEC</td>
							<td class="slider">
								<i class="fa fa-angle-down"></i>
								<% for(var i=0; i < data['cve'].capec.length; i++) { %>
									<p class="left"><b><%= data['cve'].capec[i].name %></b><br><p class="left"><%= data['cve'].capec[i].description %></p></p><br>
								<% } %>
							</td>
						<% } %>
						<td class="red">CWE</td>
						<td>
							<% if(data['cve'].cwe != "Unknown") { %>
								<b><%= data['cve'].cwe.id %></b>
								<p><b>Nome: </b><%= data['cve'].cwe.name %></p>
								<p><b>Stato: </b><%= data['cve'].cwe.status %></p>
								<p><b>Categoria: </b><%= data['cve'].cwe.category %></p>
								<p><b>Descrizione: </b><%= data['cve'].cwe.description %></p>
							<% } else { %>
								<%= data['cve'].cwe %>
							<% } %>
						</td>	
					</tr>
				</table>

				<div class="cvss-container">
					<% if(data['cve'].cvss != 'NONE') { %>
						<table>
							<tr>
								<th colspan="6">CVSS</th>
							</tr>
							<tr>
								<td class="red">Valore base</td>
								<td><%= data['cve'].cvss %></td>
								<td class="red">Impatto</td>
								<td><%= data['cve'].impactScore %></td>
								<td class="red">Sfruttabilità</td>
								<td><%= data['cve'].exploitabilityScore %></td>
							</tr>
							<tr>
								<td class="red">Accesso</td>
								<td colspan="5">
									<table>
										<tr>
											<th>Vettore</th>
											<th>Complessità</th>
											<th>Autenticazione</th>
										<tr>
										<tr>
											<td><%= data['cve'].access.vector %></td>
											<td><%= data['cve'].access.complexity %></td>
											<td><%= data['cve'].access.authentication %></td>
									</table>
								</td>
							</tr>
							<tr>
								<td class="red">Impatto</td>
								<td colspan="5">
									<table>
										<tr>
											<th>Confidenzialità</th>
											<th>Integrità</th>
											<th>Disponibilità</th>
										<tr>
										<tr>
											<td><%= data['cve'].impact.confidentiality %></td>
											<td><%= data['cve'].impact.integrity %></td>
											<td><%= data['cve'].impact.availability %></td>
									</table>
								</td>
							</tr>
						</table>
					<% } %>
					
					<% if(data['cve'].cvss3 != 'NONE') { %>
						<table>
							<tr>
								<th colspan="6">CVSS3</th>
							</tr>
							<tr>
								<td class="red">Valore base</td>
								<td><%= data['cve'].cvss3 %></td>
								<td class="red">Impatto</td>
								<td><%= data['cve'].impactScore3 %></td>
								<td class="red">Sfruttabilità</td>
								<td><%= data['cve'].exploitabilityScore3 %></td>
							</tr>
							<tr>
								<td class="red">Accesso</td>
								<td colspan="5">
									<table>
										<tr>
											<th>Complessità attacco</th>
											<th>Vettore attacco</th>
											<th>Privilegi richiesti</th>
											<th>Scope</th>
											<th>Interazione utente</th>
										<tr>
										<tr>
											<td><%= data['cve'].access3.attackcomplexity %></td>
											<td><%= data['cve'].access3.attackvector %></td>
											<td><%= data['cve'].access3.privilegesrequired %></td>
											<td><%= data['cve'].access3.scope %></td>
											<td><%= data['cve'].access3.userinteraction %></td>
									</table>
								</td>
							</tr>
							<tr>
								<td class="red">Impatto</td>
								<td colspan="5">
									<table>
										<tr>
											<th>Confidenzialità</th>
											<th>Integrità</th>
											<th>Disponibilità</th>
										<tr>
										<tr>
											<td><%= data['cve'].impact3.confidentiality %></td>
											<td><%= data['cve'].impact3.integrity %></td>
											<td><%= data['cve'].impact3.availability %></td>
									</table>
								</td>
							</tr>
						</table>
					<% } %> 
				</div>	
			</div>
		</div>
	</body>
<% } %>
</html>
<!DOCTYPE html>
<html>
<% if(data.status != 200) { %>
	<%- include('../common/error.ejs', {data: data}) %>
<% } else { %>
	<head>
		<%- include('../common/imports.ejs') %>
		<link rel="stylesheet" href="/static/styles/cve.css">
		<script src="/static/scripts/cve.js" type="text/javascript"></script>
		<title>Monitoraggio CVE</title>
	</head>
	<body onload="setCVE(<%= data.total %>, <%= data.default %>); getCVE(0);">
		<%- include('../common/header.ejs') %>
		<div class="body-container">
			<input type="hidden" id="page" value="0" />

			<div class="cve-container" id="cve-container">

				<div class="interactions">
					<button type="button" class="option" id="toggleFilters">Filtri <i class="fa fa-filter"></i></button>
					<button type="button" class="option" id="changeSearch">Ricerca per venditore</button>
					<p id="searchType"></p>
					<div id="filters">
						<div id="cve-filters">
							<div class="time">
								<p>Intervallo di tempo</p>
								<select id="timeT_selector" onchange="showOption(event)">
									<option value="AT" selected="selected">Tutto</option>
									<option value="from">Da</option>
									<option value="until">Fino a</option>
									<option value="between">Tra</option>
									<option value="outside">Non durante</option>
								</select>
								<input type="date" id="startDate" name="time-start" disabled>
								<input type="date" id="endDate" name="time-stop" disabled>
								<select id="timeType_selector">
									<option value="Published">Data Pubblicazione</option>
									<option value="Modified">Ultimo aggiornamento</option>
								</select>
							</div>
							<div class="cvss">
								<p>CVSS</p>
								<select id="cvss_selector">
									<option value="V2" selected="selected">V2</option>
									<option value="V3">V3</option>
								</select>
								<select id="timeC_selector" onchange="showOption(event)">
									<option value="AC" selected="selected">Tutto</option>
									<option value="above">Maggiore</option>
									<option value="equals">Uguale</option>
									<option value="below">Minore</option>
								</select>
								<input type="number" id="score" min="0" step="0.1" max="10" value="0" disabled>
							</div>
							<div class="rejected">
								<p>Rifiutati</p>
								<select id="rejected_selector">
									<option value="hide" selected="selected">Nascondi</option>
									<option value="show">Mostra</option>
								</select>
							</div>
						</div>
						<div class="regex_search">
							<p>Ricerca regex</p>
							<input type="text" class="search" id="search" placeholder="Ricerca CVE" />
						</div>
						<div class="enable">
							<p>Abilita filtri</p>
							<input type="checkbox" id="enableFilter" name="enableFilter" onchange="if(this.checked){alert('Filtri attivi')}">
							<br>
						</div>
						<button type="button" class="filterSearch" id="filterSearch">Cerca <i class="fa fa-search"></i></button>
					</div>
					<div>
						<div class="entries_picker">
							<span>Mostra </span>
							<select class="entries" id="entries">
								<option value="10">10</option>
								<option value="25">25</option>
								<option value="50">50</option>
							</select>
							<span> righe</span>
						</div>
						<div>
							<button type="button" id="backBtn">Tabella precedente</button>
						</div>
					</div>
				</div>
		  		
		  		<div class="table-container">
					<table id="cve-table" class="sortable">
						<thead>
							<tr>
								<th style="width: 50px;">#</th>
							    <th style="width: 150px;" class="sorttable_nosort">ID</th>
							    <th style="width: 70px;">CVSS2</th>
							    <th style="width: 70px;">CVSS3</th>
							    <th class="sorttable_nosort">Descrizione</th>
							    <th style="width: 200px;">Ultimo aggiornamento</th>
							    <th style="width: 200px;">Data pubblicazione</th>
						  	</tr>
					  	</thead>
					  	<tbody>

					  	</tbody>
					</table>
				</div>

				<div class="controls-container">
					<p class="info_entries" id="info_entries">Mostrando da <span id="start">1</span> a <span id="end"><%= data.default %></span> di <span id="total"><%= data.total %></span> righe</p>
					<div id="controls" class="controls">
						<button type="button" id="previous">Precedente</button>
						<button type="button" name="controls" id="control0" class="active">1</button>
						<button type="button" name="controls" id="control1">2</button>
						<button type="button" name="controls" id="control2">3</button>
						<button type="button" name="controls" id="control3">4</button>
						<button type="button" name="controls" id="control4">5</button>
						<button type="button" name="controls" id="control5">...</button>
						<button type="button" name="controls" id="control6">
							<script>document.write(Math.ceil(parseInt(<%= data.total %>) / <%= data.default %>))</script>
						</button>
						<button type="button" id="next">Successivo</button>
					</div>
				</div>
			</div>
		</div>
		<div id="loadingModal" class="modal">
			<a class="modalBack" href="/">Torna alla Home</a>
		</div>
	</body>
<% } %>
</html>
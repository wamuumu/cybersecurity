<html>
<head>
	<%- include('../common/imports.ejs') %>
	<link rel="stylesheet" href="/static/styles/cve.css">
	<script src="/static/scripts/cve.js" type="text/javascript"></script>
	<title>CVE</title>
</head>
<body onload="setCommon(<%= total %>); getCVE(0);">
	<%- include('../common/header.ejs') %>
	<div class="body-container">
		<input type="hidden" id="page" value="0" />

		<div class="cve-container">

			<div class="interactions">
				<div class="entries_picker">
					<p>Show </p>
					<select class="entries" id="entries" onchange="getCVE(0)">
						<option value="10">10</option>
						<option value="25">25</option>
						<option value="50" selected="selected">50</option>
						<option value="100">100</option>
					</select>
					<p> entries</p>
				</div>
			</div>
	  
			<table id="cve-table" class="sortable">
				<thead>
					<tr>
						<th style="width: 50px;">#</th>
					    <th style="width: 150px;" class="sorttable_nosort">ID</th>
					    <th style="width: 70px;">CVSS</th>
					    <th style="width: 70px;">CVSS3</th>
					    <th class="sorttable_nosort">Summary</th>
					    <th style="width: 160px;">Last Update</th>
					    <th style="width: 160px;">Published</th>
				  	</tr>
			  	</thead>
			  	<tbody>

			  	</tbody>
			</table>

			<div class="controls-container">
				<p class="info_entries">Showing <span id="start">1</span> to <span id="end">50</span> of <%= total %> entries</p>
				<div id="controls" class="controls">
					<button type="button" onclick="getCVE(parseInt(document.getElementById('page').value) - 1)">Precedente</button>
					<button class="active" name="controls" id="control0" type="button" onclick="getCVE(0)">1</button>
					<button type="button" name="controls" id="control1">2</button>
					<button type="button" name="controls" id="control2">3</button>
					<button type="button" name="controls" id="control3">4</button>
					<button type="button" name="controls" id="control4">5</button>
					<button type="button" name="controls" id="control5">...</button>
					<button type="button" name="controls" id="control6" onclick="getCVE(Math.ceil(parseInt(<%= total %>) / 50) - 1)">
						<script>document.write(Math.ceil(parseInt(<%= total %>) / 50))</script>
					</button>
					<button type="button" onclick="getCVE(parseInt(document.getElementById('page').value) + 1)">Successivo</button>
				</div>
			</div>
		</div>

		<div id="loading" class="modal">
			<div class="modal-content">
				<div class="loading">
					<img src="/static/images/ajaxload.gif" />
					<p>Loading...</p>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
<html>
<head>
	<%- include('../common/imports.ejs') %>
	<link rel="stylesheet" href="/static/styles/cve.css">
	<script src="/static/scripts/cve.js" type="text/javascript"></script>
	<title>CVE</title>
</head>
<script>
	var first = document.getElementById('control0');
</script>
<body onload="setCommon(<%= total %>); getCVE(0);">
	<%- include('../common/header.ejs') %>
	<div class="body-container">
		<input type="hidden" id="page" value="0" />

		<div class="cve-container">

			<div class="interactions">
				<button type="button" id="toggleFilters">Filtri <i class="fa fa-filter"></i></button>
				<div id="filters">
					<div class="time">
						<p>Tempo</p>
						<select id="timeT_selector" onchange="showOption(event)">
							<option value="AT" selected="selected">Tutto</option>
							<option value="from">Da</option>
							<option value="until">Fino a</option>
							<option value="between">Tra</option>
							<option value="outside">Non durante</option>
						</select>
						<input type="date" id="startDate" name="time-start" disabled>
						<input type="date" id="endDate" name="time-stop" disabled>
						<select id="timeType_selector">
							<option value="Published">Data Pubblicazione</option>
							<option value="Modified">Ultimo aggiornamento</option>
						</select>
					</div>
					<div class="cvss">
						<p>CVSS</p>
						<select id="cvss_selector">
							<option value="V2" selected="selected">V2</option>
							<option value="V3">V3</option>
						</select>
						<select id="timeC_selector" onchange="showOption(event)">
							<option value="AC" selected="selected">Tutto</option>
							<option value="above">Maggiore</option>
							<option value="equals">Uguale</option>
							<option value="below">Minore</option>
						</select>
						<input type="number" id="score" min="0" step="0.1" max="10" value="0" disabled>
					</div>
					<div class="rejected">
						<p>Rifiutati</p>
						<select id="rejected_selector">
							<option value="hide" selected="selected">Nascondi</option>
							<option value="show">Mostra</option>
						</select>
					</div>
					<div class="enable">
						<p>Filtri</p>
						<input type="checkbox" id="enableFilter" name="enableFilter" onchange="if(this.checked){alert('Filtri attivi')}">
						<br>
					</div>
					<button type="button" class="filterSearch" id="filterSearch" onclick="getCVE(0)">Cerca <i class="fa fa-search"></i></button>
				</div>
				<div class="entries_picker">
					<p>Mostra </p>
					<select class="entries" id="entries" onchange="getCVE(0)">
						<option value="10">10</option>
						<option value="25">25</option>
						<option value="50" selected="selected">50</option>
						<option value="100">100</option>
					</select>
					<p> righe</p>
				</div>
			</div>
	  
			<table id="cve-table" class="sortable">
				<thead>
					<tr>
						<th style="width: 50px;">#</th>
					    <th style="width: 150px;" class="sorttable_nosort">ID</th>
					    <th style="width: 70px;">CVSS2</th>
					    <th style="width: 70px;">CVSS3</th>
					    <th class="sorttable_nosort">Descrizione</th>
					    <th style="width: 200px;">Ultimo aggiornamento</th>
					    <th style="width: 200px;">Data pubblicazione</th>
				  	</tr>
			  	</thead>
			  	<tbody>

			  	</tbody>
			</table>

			<div class="controls-container">
				<p class="info_entries">Mostrando da <span id="start">1</span> a <span id="end">50</span> di <span id="total"><%= total %></span> righe</p>
				<div id="controls" class="controls">
					<button type="button" onclick="getCVE(parseInt(document.getElementById('page').value) - 1)">Precedente</button>
					<button class="active" name="controls" id="control0" type="button" onclick="getCVE(0)">1</button>
					<button type="button" name="controls" id="control1">2</button>
					<button type="button" name="controls" id="control2">3</button>
					<button type="button" name="controls" id="control3">4</button>
					<button type="button" name="controls" id="control4">5</button>
					<button type="button" name="controls" id="control5">...</button>
					<button type="button" name="controls" id="control6" onclick="getCVE(Math.ceil(parseInt(<%= total %>) / 50) - 1)">
						<script>document.write(Math.ceil(parseInt(<%= total %>) / 50))</script>
					</button>
					<button type="button" onclick="getCVE(parseInt(document.getElementById('page').value) + 1)">Successivo</button>
				</div>
			</div>
		</div>

		<div id="loading" class="modal">
			<div class="modal-content">
				<div class="loading">
					<img src="/static/images/ajaxload.gif" />
					<p>Loading...</p>
				</div>
			</div>
		</div>
	</div>
</body>
</html>
<html>
<head>
	<%- include('../common/imports.ejs') %>
	<link rel="stylesheet" href="/static/styles/dga.css">
	<script src="/static/scripts/dga.js" type="text/javascript"></script>
	<title>DGA Detection | Input</title>
</head>
<% if(data.status != 200) { %>
	<body onload="setError(<%= data.status %>, '<%= data.error %>')">
		<%- include('../common/error.ejs') %>
	</body>
<% } else { %>
	<body onload="resetRadio('choice')">
		<%- include('../common/header.ejs') %>
		<div class="body-container">
			DGA Detection Tool - Input
			<br><br>
			<form id="resultsForm" enctype="multipart/form-data" action="/dga-detection/result" method="POST">

				<p>Scegli il tipo di analisi da effettuare</p>
				<input type="radio" id="url" name="choice" onchange="showOption(this)" value="domain">
				<label for="url">Dominio</label><br>
				<input type="radio" id="file" name="choice" onchange="showOption(this)" value="file">
				<label for="file">File (.cef, .txt)</label><br>


				<div id="alg-container">
					<p>Scegli l'algoritmo da utilizzare</p>
					<input type="radio" id="alg1" name="algchoice" value="alg1" checked="checked">
					<label for="alg1">Algoritmo 1</label><br>
					<input type="radio" id="alg2" name="algchoice" value="alg2">
					<label for="alg2">Algoritmo 2</label><br>
				</div>

				<br>
				<div id="domain-container">
					<label for="url">Dominio: </label>
					<input type="text" id="domain" name="domain" />
				</div>
				<div id="file-container">
					<label for="filetoupload">File: </label>
					<input type="file" name="filetoupload" accept=".cef,.txt" onchange="readFile(this)" />
				</div>
				<br>
				<button type="submit" id="send_dga" onclick="resetDomain(event)" disabled>Invia</button>
			</form>

			<h3>Algoritmo 1 - specifiche </h3>
			<ul>
				<li>Salta i domini corti, i domini localizzati e i domini tor</li>
				<li>se l'<b>entropia</b> > 3.8 allora probabilmente è generato da un DGA</li>
				<li>se il numero di <b>consonanti</b> > 7 (elevato) allora probabilmente è generato da un DGA</li>
				<li>se la <b>lunghezza del dominio</b> > 12 (elevato) allora probabilmente è generato da un DGA</li>
			</ul>

			<br>
			<h3>Algoritmo 2 - specifiche </h3>
			<ul>
				<li>se il dominio è <b>esadecimale</b> allora probabilmente è generato da un DGA</li>
				<li>se il dominio è <b>hash</b> allora probabilmente è generato da un DGA</li>
				<li>se il dominio <b>contiene più di tre numeri</b> allora probabilmente è generato da un DGA</li>
				<li>se il dominio <b>contiene lettere di bassa frequenza</b> allora probabilmente è generato da un DGA</li>
				<li>se il dominio <b>contiene più di 4 consonanti vicine</b> allora probabilmente è generato da un DGA</li>
				<li>se il dominio <b>contiene un carattere ripetuto più di 4 volte</b> allora probabilmente è generato da un DGA</li>
				<li>se l'<b>entropia</b> è alta allora probabilmente è generato da un DGA</li>
				<li>se la <b>lunghezza del dominio</b> > 10 allora probabilmente è generato da un DGA</li>
				<li>se il dominio <b>non è presente</b> su Ecosia allora probabilmente è generato da un DGA</li>
			</ul>

			<br>
			<h2>Disclaimer</h2>
			<p><b>Gli algoritmi non garantiscono al 100% di riconoscere se un dominio è generato usando un DGA. Pertanto alcuni risultati potrebbero essere incorretti</b></p>
		</div>
	</body>
<% } %>
</html>